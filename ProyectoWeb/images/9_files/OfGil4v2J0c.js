/*!CK:339929285!*//*1407885696,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["hlu7P"]); }

__d("GraphQLQuery",["createObjectFrom"],function(a,b,c,d,e,f,g){function h(){"use strict";}h.prototype.addField=function(l){"use strict";if(this.fieldSet){this.fieldSet.fields.push(l);}else this.fieldSet=new k.FieldSet([l]);};h.prototype.addFields=function(l){"use strict";l.forEach(this.addField,this);};for(var i in h)if(h.hasOwnProperty(i))k[i]=h[i];var j=h===null?null:h.prototype;k.prototype=Object.create(j);k.prototype.constructor=k;k.__superConstructor__=h;function k(l,m){"use strict";this.rootCall=l;this.fieldSet=m;}k.prototype.toString=function(){"use strict";return (this.rootCall||'')+(this.fieldSet||'');};k.Call=(function(){function l(m,n){"use strict";this.name=m;this.args=n||[];}l.prototype.toString=function(){"use strict";return this.name+'('+this.args.join(',')+')';};return l;})();k.CallValue=(function(){function l(m){"use strict";this.callValue=m;}l.prototype.toString=function(){"use strict";return this.callValue.replace(/[)(}{><,.\\]/g,'\\$&');};return l;})();k.CallVariable=(function(){function l(m){"use strict";this.callVariableName=m;}l.prototype.toString=function(){"use strict";return '<'+this.callVariableName+'>';};return l;})();k.Field=(function(){for(i in h)if(h.hasOwnProperty(i))l[i]=h[i];l.prototype=Object.create(j);l.prototype.constructor=l;l.__superConstructor__=h;function l(m,n,o,p,q){"use strict";this.name=p||m;this.fieldName=m;this.calls=n||[];this.fieldSet=o;this.alias=p;this.condition=q;}l.prototype.toString=function(){"use strict";var m='';if(this.condition)m+=this.condition+'?';m+=this.fieldName;if(this.calls.length!==0)m+='.'+this.calls.join('.');if(this.alias)m+=' as '+this.alias;if(this.fieldSet)m+=this.fieldSet;return m;};l.prototype.addCall=function(m){"use strict";this.calls.push(m);};l.prototype.removeCalls=function(m){"use strict";var n=g(m),o=[];for(var p=0;p<this.calls.length;p++)if(!n[this.calls[p].name])o.push(this.calls[p]);this.calls=o;};return l;})();k.FieldSet=(function(){function l(m){"use strict";this.fields=m||[];}l.prototype.toString=function(){"use strict";return '{'+this.fields.join(',')+'}';};return l;})();e.exports=k;},null);
__d("GraphQLParser",["GraphQLQuery"],function(a,b,c,d,e,f,g){function h(l){"use strict";this.queryString=l;this.queryLength=l.length;this.index=-1;this.character=null;this.next();}h.prototype.error=function(l){"use strict";throw new h.SyntaxError(this.queryString,this.index,l);};h.prototype.next=function(l){"use strict";if(l&&l!==this.character)this.error('Expected "'+l+'" instead of "'+this.character+'".');this.index++;if(this.index>this.queryLength){this.error('Expected another character, but at end of string.');}else this.character=this.index===this.queryLength?null:this.queryString[this.index];};h.prototype.end=function(){"use strict";if(this.character)this.error('Expected end of string instead of '+this.character+'.');};h.prototype.whitespace=function(){"use strict";while(this.character===' '||this.character==='\t'||this.character==='\r'||this.character==='\n')this.next();};h.prototype.query=function(l){"use strict";var m=null;if(l){m=new g.Call(this.name(),this.callArguments());this.whitespace();}var n=null;if(this.character==='{')n=this.fieldSet();return new g(m,n);};h.prototype.name=function(){"use strict";var l=this.index;if(this.character===':')this.error('Name cannot begin with :');while(j(this.character))this.next();if(this.index===l)this.error('Expected name.');return this.queryString.substr(l,this.index-l);};h.prototype.fieldSet=function(){"use strict";var l=[];this.next('{');this.whitespace();l.push(this.field());this.whitespace();while(this.character===','){this.next(',');this.whitespace();l.push(this.field());this.whitespace();}this.next('}');return new g.FieldSet(l);};h.prototype.field=function(){"use strict";var l,m,n=this.name();this.whitespace();if(this.character==='?'){this.next('?');this.whitespace();l=this.name();m=n;}else l=n;this.whitespace();var o=this.calls(),p;if(this.character==='a'){this.next('a');this.next('s');this.whitespace();p=this.name();}this.whitespace();var q;if(this.character==='{')q=this.fieldSet();return new g.Field(l,o,q,p,m);};h.prototype.calls=function(){"use strict";var l=[];while(this.character==='.'){this.next('.');this.whitespace();l.push(new g.Call(this.name(),this.callArguments()));this.whitespace();}return l;};h.prototype.callArguments=function(){"use strict";this.next('(');this.whitespace();var l=[];if(this.character!==')'){l.push(this.callArgument());while(this.character===','){this.next(',');this.whitespace();l.push(this.callArgument());}}this.next(')');return l;};h.prototype.callArgument=function(){"use strict";return this.character==='<'?this.callVariable():this.callValue();};h.prototype.callVariable=function(){"use strict";this.next('<');var l=this.name();this.next('>');return new g.CallVariable(l);};h.prototype.callValue=function(){"use strict";var l=this.index,m=false;while(k(this.character)){if(this.character==='\\'){this.next();m=true;}this.next();}if(this.index===l)this.error('Expected call value.');var n=this.index-l,o=this.queryString.substr(l,n);o=o.replace(/\s+$/,'');if(m)for(var p=0;p<n;++p)if(o[p]==='\\'){o=o.substr(0,p)+o.substr(p+1);--n;}return new g.CallValue(o);};h.SyntaxError=(function(){for(var l in Error)if(Error.hasOwnProperty(l))n[l]=Error[l];var m=Error===null?null:Error.prototype;n.prototype=Object.create(m);n.prototype.constructor=n;n.__superConstructor__=Error;function n(o,p,q){"use strict";this.queryString=o;this.character=p;this.parserError=q;this.message='Syntax error "'+q+'" '+'at character '+p+' '+'near "'+i(o,p)+'" '+'in query: '+o;}return n;})();function i(l,m){return (l.substr(0,m+1).replace(/\s+/g,' ').substr(-10)+'\u20DD'+l.substr(m+1).replace(/\s+/g,' ').substr(0,10));}function j(l){if(l===null)return false;return l==='_'||l===':'||l==='-'||(l>='0'&&l<='9')||(l>='A'&&l<='Z')||(l>='a'&&l<='z');}function k(l){if(l===null)return false;return l!='('&&l!=')'&&l!='{'&&l!='}'&&l!='<'&&l!='>'&&l!='.'&&l!=',';}h.parseQuery=function(l){var m=new h(l);m.whitespace();var n=m.query(true);m.whitespace();m.end();return n;};h.parseRootlessQuery=function(l){var m=new h(l);m.whitespace();var n=m.query(false);m.whitespace();m.end();return n;};e.exports=h;},null);
__d("PagedQuery",["GraphQLParser","GraphQLQuery","keyOf","isEmpty"],function(a,b,c,d,e,f,g,h,i,j){function k(l,m){"use strict";this.$PagedQuery0=l;this.$PagedQuery1=m;}k.prototype.$PagedQuery2=function(){"use strict";var l=this.findFieldByPath(this.$PagedQuery0);l.removeCalls(['find','after','before','first','last']);return l;};k.prototype.$PagedQuery3=function(l,m,n){"use strict";var o=this.$PagedQuery2(),p=n?'after':'before';o.addCall(new h.Call(p,[l]));var q=n?'first':'last';o.addCall(new h.Call(q,[m]));return this.$PagedQuery0.toString();};k.prototype.$PagedQuery4=function(l){"use strict";var m=this.$PagedQuery1[l];if(typeof m=='object'&&!j(m))return i(m);return null;};k.prototype.$PagedQuery5=function(l){"use strict";var m=this.$PagedQuery4(l);if(m)return m;return this.$PagedQuery1[l];};k.prototype.$PagedQuery6=function(l){"use strict";var m=this.$PagedQuery4(l);if(m)return this.$PagedQuery1[l][m];return this.$PagedQuery1[l];};k.prototype.pageAfterQueryString=function(l,m){"use strict";return this.$PagedQuery3(l,m,true);};k.prototype.pageBeforeQueryString=function(l,m){"use strict";return this.$PagedQuery3(l,m,false);};k.prototype.pageFirstQueryString=function(l){"use strict";var m=this.$PagedQuery2();m.addCall(new h.Call('first',[l]));return this.$PagedQuery0.toString();};k.prototype.pageLastQueryString=function(l){"use strict";var m=this.$PagedQuery2();m.addCall(new h.Call('last',[l]));return this.$PagedQuery0.toString();};k.prototype.findFieldByPath=function(l){"use strict";var m=l,n=this.$PagedQuery5(0);if(l.rootCall.name!=n)throw new Error("Query path does not match root query at top node, "+"expected "+n+", "+"found "+l.name+" instead.");for(var o=1;o<this.$PagedQuery1.length;o++){var p=m.fieldSet.fields,q=false,r=this.$PagedQuery5(o);for(var s=0;s<p.length;s++)if(p[s].fieldName==r){m=p[s];q=true;break;}if(!q)throw new Error("Query path does not match query structure at location "+o+", "+"expected "+r+", "+"not located in "+p);}return m;};k.prototype.findDataByPath=function(l){"use strict";var m=l;for(var n=0;n<this.$PagedQuery1.length;n++){var o=this.$PagedQuery6(n);if(!m||!m[o])throw new Error("Query path does not match payload at location "+n+", "+"expected "+o);m=m[o];}return m;};k.constructFromPath=function(l,m){return new k(g.parseQuery(l),m);};e.exports=k;},null);
__d("PagedQueryCache",["KeyedCallbackManager","GraphQLParser","emptyFunction","merge","mergeInto"],function(a,b,c,d,e,f,g,h,i,j,k){function l(m,n,o,p){"use strict";this.$PagedQueryCache0=this.$PagedQueryCache0.bind(this,m),this.$PagedQueryCache1=n;this.$PagedQueryCache2=j({enableLooping:false},p);var q=this.$PagedQueryCache1.findDataByPath(o),r=q.edges;this.$PagedQueryCache3=q.page_info;this.$PagedQueryCache4=new g();this.$PagedQueryCache5={};this.$PagedQueryCache6={};this.$PagedQueryCache7={};this.$PagedQueryCache8=0;this.$PagedQueryCache9=0;this.$PagedQueryCachea={};this.$PagedQueryCacheb(r,0);if(this.$PagedQueryCache2.allDataLoaded)this.$PagedQueryCachec();}l.prototype.$PagedQueryCache0=function(m,n,o,p,q,r,s){"use strict";var t=h.parseQuery(n),u=o.findFieldByPath(t),v={};for(var w=0;w<u.calls.length;w++){var x=u.calls[w];if(x.args.length>0)v[x.name]=x.args[0].callValue;}k(v,r);m(n,o,p,q,v,s);};l.prototype.$PagedQueryCacheb=function(m,n){"use strict";var o={},p=false;for(var q=0;q<m.length;q++){if(this.hasLooped())break;var r=n+q,s=m[q].cursor,t=m[q].node,u=this.$PagedQueryCache5[s];if(this.$PagedQueryCache2.enableLooping&&u!==undefined){p=true;continue;}var v=this.$PagedQueryCache4.getResource(r);if(v!==undefined&&v!=s)throw new Error('Attempting to add cursor '+s+' at location '+r+' which already contains cursor '+v);this.$PagedQueryCache7[t.id]=s;this.$PagedQueryCache6[s]=t;o[r]=s;this.$PagedQueryCache5[s]=r;this.$PagedQueryCache8=Math.min(r,this.$PagedQueryCache8);this.$PagedQueryCache9=Math.max(r,this.$PagedQueryCache9);}if(p)this.$PagedQueryCachec();this.$PagedQueryCache4.addResourcesAndExecute(o);};l.prototype.getItemsAfterCursor=function(m,n,o){"use strict";return this.$PagedQueryCached(m,n,true,o);};l.prototype.getItemsBeforeCursor=function(m,n,o){"use strict";return this.$PagedQueryCached(m,n,false,o);};l.prototype.$PagedQueryCachee=function(m){"use strict";if(!this.hasLooped())return m;var n=this.$PagedQueryCachef.end-this.$PagedQueryCachef.start+1;while(m<this.$PagedQueryCachef.start||m>this.$PagedQueryCachef.end)if(m<this.$PagedQueryCachef.start){m+=n;}else m-=n;return m;};l.prototype.$PagedQueryCached=function(m,n,o,p){"use strict";var q=this.$PagedQueryCacheg(m);if(!o)q=q-n-1;var r=[];for(var s=1;s<=n;s++)r.push(this.$PagedQueryCachee(q+s));var t=this.$PagedQueryCache4.getUnavailableResourcesFromRequest(r);if(t.length){t=this.$PagedQueryCacheh(t);if(!t.length)return;var u;if(o){if(this.$PagedQueryCache2.enableLooping&&!this.hasNextPage(m)){u=this.$PagedQueryCache1.pageFirstQueryString(n);}else u=this.$PagedQueryCache1.pageAfterQueryString(m,n);}else if(this.$PagedQueryCache2.enableLooping&&!this.hasPreviousPage(m)){u=this.$PagedQueryCache1.pageLastQueryString(n);}else u=this.$PagedQueryCache1.pageBeforeQueryString(m,n);for(var v=0;v<t.length;++v)this.$PagedQueryCachea[t[v]]=true;this.$PagedQueryCachei&&this.$PagedQueryCachei();this.$PagedQueryCache0(u,this.$PagedQueryCache1,t,o?this.$PagedQueryCache2.first_query:this.$PagedQueryCache2.last_query,this.$PagedQueryCache2.persistent_params,this.$PagedQueryCachej.bind(this));}var w=function(x){var y=[];for(var z=0;z<n;z++)y.push(this.$PagedQueryCache6[x[r[z]]]);return y;}.bind(this);return this.$PagedQueryCache4.deferredExecuteOrEnqueue(r).then(w).addCallback(p,this);};l.prototype.$PagedQueryCachej=function(){"use strict";this.$PagedQueryCachek.apply(this,arguments);};l.prototype.$PagedQueryCacheg=function(m){"use strict";var n=this.$PagedQueryCache5[m];if(n===undefined)throw new Error("Cursor not found: the request can still be made but the result "+"would not link to the existing data");return n;};l.prototype.setPayloadCallback=function(m){"use strict";this.$PagedQueryCachek=m;};l.prototype.updateData=function(m){"use strict";var n=this.$PagedQueryCache1.findDataByPath(m.query_results),o=n&&n.edges;if(!o)return;for(var p=0;p<o.length;++p){var q=o[p].cursor,r=o[p].node;if(this.$PagedQueryCache6[q]===undefined)this.$PagedQueryCache6[q]={};for(var s in r)this.$PagedQueryCache6[q][s]=r[s];}};l.prototype.addData=function(m){"use strict";var n=false,o=null,p=0;for(var q in m.query_params){if(q=='after'||q=='before')o=m.query_params[q];if(q=='first'||q=='last'){n=(q=='first');p=m.query_params[q];}}if(this.$PagedQueryCache2.enableLooping&&!o)o=n?this.$PagedQueryCache3.end_cursor:this.$PagedQueryCache3.start_cursor;if(!o||this.$PagedQueryCache5[o]===undefined)return;var r=this.$PagedQueryCache5[o],s=this.$PagedQueryCache1.findDataByPath(m.query_results);if(!s.edges.length){this.$PagedQueryCachel(m.requested_indices);if(n){this.$PagedQueryCache3.has_next_page=false;this.$PagedQueryCache2.enableLooping&&this.getItemsAfterCursor(o,p,i);}else{this.$PagedQueryCache3.has_previous_page=false;this.$PagedQueryCache2.enableLooping&&this.getItemsBeforeCursor(o,p,i);}return;}var t;if(n){t=r+1;this.$PagedQueryCache3.end_cursor=s.page_info.end_cursor;this.$PagedQueryCache3.has_next_page=s.page_info.has_next_page;}else{t=r-s.edges.length;this.$PagedQueryCache3.start_cursor=s.page_info.start_cursor;this.$PagedQueryCache3.has_previous_page=s.page_info.has_previous_page;}this.$PagedQueryCacheb(s.edges,t);this.$PagedQueryCachel(m.requested_indices);};l.prototype.hasNextPage=function(m){"use strict";var n=this.$PagedQueryCacheg(m);if(this.$PagedQueryCache4.getResource(n+1)){return true;}else if(m==this.$PagedQueryCache3.end_cursor){return this.$PagedQueryCache3.has_next_page;}else throw new Error('hasNextPage called on unknown cursor');};l.prototype.hasPreviousPage=function(m){"use strict";var n=this.$PagedQueryCacheg(m);if(this.$PagedQueryCache4.getResource(n-1)){return true;}else if(m==this.$PagedQueryCache3.start_cursor){return this.$PagedQueryCache3.has_previous_page;}else throw new Error('hasPreviousPage called on unknown cursor');};l.prototype.hasLooped=function(){"use strict";return this.$PagedQueryCache2.enableLooping&&this.$PagedQueryCachef;};l.prototype.getItemAtIndex=function(m,n){"use strict";m=this.$PagedQueryCachee(m);var o=function(p){n(this.$PagedQueryCache6[p[m]]);}.bind(this);this.$PagedQueryCache4.deferredExecuteOrEnqueue([m]).addCallback(o,this);};l.prototype.getItemAtIndexImmediate=function(m){"use strict";m=this.$PagedQueryCachee(m);var n=this.$PagedQueryCache4.getResource(m),o;if(n)o=this.$PagedQueryCache6[n];return o;};l.prototype.getAvailableRange=function(){"use strict";var m=this.$PagedQueryCacheg(this.$PagedQueryCache3.start_cursor),n=this.$PagedQueryCacheg(this.$PagedQueryCache3.end_cursor);return {offset:m,length:n-m+1};};l.prototype.getCursorForID=function(m){"use strict";return this.$PagedQueryCache7[m];};l.prototype.getIndexForID=function(m){"use strict";var n=this.getCursorForID(m);return (n!==undefined)?this.$PagedQueryCache5[n]:undefined;};l.prototype.$PagedQueryCachel=function(m){"use strict";if(m)for(var n=0;n<m.length;++n)delete(this.$PagedQueryCachea[m[n]]);};l.prototype.$PagedQueryCacheh=function(m){"use strict";if(!this.$PagedQueryCachea)return m;var n=[];for(var o=0;o<m.length;++o)if(!this.$PagedQueryCachea[m[o]])n.push(m[o]);return n;};l.prototype.$PagedQueryCachec=function(){"use strict";this.$PagedQueryCachef={start:this.$PagedQueryCache8,end:this.$PagedQueryCache9};};l.prototype.setPreFetchCallback=function(m){"use strict";this.$PagedQueryCachei=m;};e.exports=l;},null);
__d("PhotoStorePagedQueryCacheCore",["PagedQuery","PagedQueryCache","merge"],function(a,b,c,d,e,f,g,h,i){for(var j in h)if(h.hasOwnProperty(j))l[j]=h[j];var k=h===null?null:h.prototype;l.prototype=Object.create(k);l.prototype.constructor=l;l.__superConstructor__=h;function l(m,n){"use strict";var o=m.query_results,p=m.query_metadata,q=g.constructFromPath(p.query_string,p.query_path);this.$PhotoStorePagedQueryCacheCore0=m.set_id;this.$PhotoStorePagedQueryCacheCore1=m.payloadsource;k.constructor.call(this,n,q,o,i({enableLooping:true},p.config));this.setPayloadCallback(this.$PhotoStorePagedQueryCacheCore2.bind(this));}l.prototype.$PhotoStorePagedQueryCacheCore2=function(m){"use strict";m.set_id=this.$PhotoStorePagedQueryCacheCore0;this.broadcastUpdate(this.$PhotoStorePagedQueryCacheCore1,m);};l.prototype.broadcastUpdate=function(m,n){"use strict";};e.exports=l;},null);
__d("sendPagedQueryRequestDefault",["AsyncRequest"],function(a,b,c,d,e,f,g){function h(i,j,k,l,m,n){new g('/ajax/graphql/query/').setData({queryName:l,params:m}).setHandler(function(o){var p=o.getPayload();n({requested_indices:k,query_results:JSON.parse(p.output),query_metadata:{query_string:p.query},query_params:m});}).setAllowCrossPageTransition(true).send();}e.exports=h;},null);
__d("BadgedButton",["Button.react","React","cx","joinClasses"],function(a,b,c,d,e,f,g,h,i,j){var k=h.createClass({displayName:'BadgedButton',render:function(){var l=this.props.count>1?this.props.pluralLabel:this.props.singularLabel,m=null;if(this.props.count>0)m=(h.createElement(h.DOM.div,{className:(("_4_-d")+(this.props.bounce?' '+"_3yk":''))},this.props.count));return (h.createElement(h.DOM.div,Object.assign({},this.props,{className:j(this.props.className,"_4_-e")}),h.createElement(g,{label:l,use:"confirm",size:"large",className:"_4_-f"}),m));}});e.exports=k;},null);
__d("PhotoCentralUpdates",["Arbiter","merge"],function(a,b,c,d,e,f,g,h){var i={handleUpdate:function(j,k){var l=h({payloadsource:j},k);g.inform('update-photos',l);},handlePhotoSets:function(j,k){var l=h({payloadsource:j},k);g.inform('update-photosets',l);}};e.exports=i;},null);
__d("PhotoStorePagedQueryCache",["PhotoCentralUpdates","PhotoStorePagedQueryCacheCore","sendPagedQueryRequestDefault"],function(a,b,c,d,e,f,g,h,i){for(var j in h)if(h.hasOwnProperty(j))l[j]=h[j];var k=h===null?null:h.prototype;l.prototype=Object.create(k);l.prototype.constructor=l;l.__superConstructor__=h;function l(m,n){"use strict";k.constructor.call(this,m,n||i);}l.prototype.broadcastUpdate=function(m,n){"use strict";g.handleUpdate(m,n);};e.exports=l;},null);
__d("SpotlightViewerBottomBar",["LeftRight.react","React","cx","joinClasses"],function(a,b,c,d,e,f,g,h,i,j){var k=h.createClass({displayName:'SpotlightViewerBottomBar',render:function(){var l=Array.isArray(this.props.children)?this.props.children:[this.props.children],m="_4_8n _51an";if(this.props.className)m=j(m,this.props.className);if(l.length===1)return (h.createElement(h.DOM.div,{className:m},l[0]));m=j(m,"_50-m");return (h.createElement(g,{className:m},l[0],l[1]));}});e.exports=k;},null);
__d("SpotlightViewerBottomBarGroup",["React","cx"],function(a,b,c,d,e,f,g,h){var i=g.createClass({displayName:'SpotlightViewerBottomBarGroup',render:function(){var j=this.props.itemmargin||'right',k=((j=='left'?"marginLeft":'')+(j=='right'?' '+"marginRight":'')+(' '+"_4_8i"));return (g.createElement(g.DOM.div,{className:k},this.props.children));}});e.exports=i;},null);
__d("SpotlightViewerBottomBarLink",["Link.react","React","cx"],function(a,b,c,d,e,f,g,h,i){var j=h.createClass({displayName:'SpotlightViewerBottomBarLink',render:function(){return (h.createElement(g,{className:"_4_8j _4_8k",onClick:this.props.onClick},this.props.children));}});e.exports=j;},null);
__d("SpotlightViewerCheck",["Link.react","React","cx"],function(a,b,c,d,e,f,g,h,i){var j=h.createClass({displayName:'SpotlightViewerCheck',getInitialState:function(){return {selected:this.props.selected};},render:function(){var k=((this.props.selected?"_4_d3":'')+(' '+"_4_d2")+(' '+"_51an")+(' '+"_4bi")+(this.props.bounce?' '+"_3yk":''));return h.createElement(g,{className:k,onClick:this.props.onClick});}});e.exports=j;},null);
__d("SpotlightViewerCroppingBar",["React","SpotlightViewerBottomBar","SpotlightViewerBottomBarGroup","SpotlightViewerBottomBarLink","cx","tx"],function(a,b,c,d,e,f,g,h,i,j,k,l){var m=g.createClass({displayName:'SpotlightViewerCroppingBar',_getBarGroupContents:function(){if(this.props.saving)return (g.createElement(g.DOM.span,{className:"_4_8j"},"Saving your new profile picture"));return [g.createElement(j,{onClick:this.props.onDone},"Terminado de recortar"),g.createElement(j,{onClick:this.props.onCancel},"Cancelar")];},render:function(){return (g.createElement(h,null,g.createElement(i,null,this._getBarGroupContents())));}});e.exports=m;},null);
__d("SpotlightViewerOptionsMenu",["ContextualLayerAutoFlip","React","ReactMenu","PopoverMenu.react","SpotlightViewerBottomBarLink","tx"],function(a,b,c,d,e,f,g,h,i,j,k,l){var m=i.Item,n=h.createClass({displayName:'SpotlightViewerOptionsMenu',_onItemClick:function(o,p){this.props.callback&&this.props.callback(p.item.getValue());},render:function(){var o=h.createElement(i,{onItemClick:this._onItemClick},this.props.items.map(function(p){return (h.createElement(m,{value:p.value,title:p.label,href:p.href||'#'},p.label));}));return (h.createElement(j,{menu:o,layerBehaviors:[g],onShow:this.props.onShow,onHide:this.props.onHide},h.createElement(k,null,"Options")));}});e.exports=n;},null);
__d("SpotlightViewerPagers",["LeftRight.react","Link.react","React","cx"],function(a,b,c,d,e,f,g,h,i,j){var k=i.createClass({displayName:'SpotlightViewerPagers',render:function(){return (i.createElement(g,null,i.createElement(h,{className:"_4-oa _4-ob _50-m"}),i.createElement(h,{className:"_4-oa _4-oc _50-m"})));}});e.exports=k;},null);
__d("SpotlightViewerPageWithKeys",["KeyEventController","SubscriptionsHandler"],function(a,b,c,d,e,f,g,h){function i(j){"use strict";this.$SpotlightViewerPageWithKeys0=j;}i.prototype.enable=function(){"use strict";this.$SpotlightViewerPageWithKeys1=new h();this.$SpotlightViewerPageWithKeys1.addSubscriptions(g.registerKey('LEFT',function(){this.$SpotlightViewerPageWithKeys0.viewState.backward();return false;}.bind(this)),g.registerKey('RIGHT',function(){this.$SpotlightViewerPageWithKeys0.viewState.forward();return false;}.bind(this)));};i.prototype.disable=function(){"use strict";this.$SpotlightViewerPageWithKeys1.release();delete this.$SpotlightViewerPageWithKeys1;};e.exports=i;},null);
__d("SpotlightViewerUpdateUrlOnNav",["PageTransitions","PhotoUtils","URI","VaultBoxURI","goURI"],function(a,b,c,d,e,f,g,h,i,j,k){function l(m){"use strict";this._viewer=m;this._registered=false;this._shouldUpdateURL=false;this._suppressNextEvent=false;}l.prototype.enable=function(){"use strict";this._registered=false;this._subscriptions=[this._viewer.subscribe('open',this._onOpen.bind(this)),this._viewer.subscribe('close',this._onClose.bind(this)),this._viewer.subscribe('photo_change',this._onPhotoChange.bind(this))];this._enabled=true;};l.prototype.disable=function(){"use strict";for(var m=0;m<this._subscriptions.length;m++)this._subscriptions[m].unsubscribe();this._subscriptions=[];this._enabled=false;};l.prototype._registerTransition=function(){"use strict";if(this._registered)return;g.registerHandler(this._handleTransition.bind(this));this._registered=true;};l.prototype._handleTransition=function(m){"use strict";if(!this._enabled)return false;if(this._shouldUpdateURL){this._shouldUpdateURL=false;g.transitionComplete();return true;}this._suppressNextEvent=true;if(this._viewer.openURL(m)){g.transitionComplete();return true;}if(this._viewer.isOpen()&&j.isVaultArchiveURI(m)){this._suppressNextEvent=true;this._viewer.close();g.transitionComplete();return true;}this._suppressNextEvent=false;return false;};l.prototype._onOpen=function(){"use strict";this._registerTransition();this._openURI=i.getMostRecentURI().getUnqualifiedURI();};l.prototype._onClose=function(){"use strict";if(this._suppressNextEvent){this._suppressNextEvent=false;return;}var m=this._viewer.removePermalinkQueryData(this._openURI);this._updateURL(m);};l.prototype._onPhotoChange=function(m,n){"use strict";if(this._suppressNextEvent){this._suppressNextEvent=false;return;}this._updateURL(h.getPermalinkFromData(n));};l.prototype._updateURL=function(m){"use strict";this._shouldUpdateURL=true;k(m);};e.exports=l;},null);
__d("SpotlightVaultViewer",["Arbiter","ArbiterMixin","AsyncDialog","AsyncRequest","BadgedButton","CSSAnimations","LoadingIndicator.react","Parent","Photocrop2","PhotosConst","PhotoStore","PhotosUploadWaterfall","PhotoUtils","ProfilePicRequestCreator","ProfilePictureFlowLogging","React","SpotlightViewer","SpotlightViewerAutoResize","SpotlightViewerBehaviorsMixin","SpotlightViewerBottomBar","SpotlightViewerBottomBarGroup","SpotlightViewerBottomBarLink","SpotlightViewerCheck","SpotlightViewerClose","SpotlightViewerCoreMixin","SpotlightViewerCroppingBar","SpotlightViewerDimensionMixin","SpotlightViewerOptionsMenu","SpotlightViewerPagers","SpotlightViewerPageWithKeys","SpotlightViewerUpdateUrlOnNav","SpotlightViewport","SubscriptionsHandler","URI","VaultBoxURI","VaultPageGrid","Vector","cx","tx"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na,oa,pa,qa,ra,sa){var ta=v.createClass({displayName:'SpotlightVaultViewer',mixins:[h,y,ea,ga],behaviors:[ka,ja,x],getViewerID:function(){return 'vaultbox';},optionsMenuValues:{DOWNLOAD:0,CROP:1,ROTATE_LEFT:2,ROTATE_RIGHT:3,MAKE_COVER_PHOTO:4},getInitialState:function(){this._grid=pa.getInstance(this.props.gridid);this._subscriptions=new ma();return {photoData:this._getInitialPhotoData(),open:true,selectionSet:this._grid.getSelectionSet(),croppingMode:false,savingMode:false,menuOpen:false,bounce:false};},_getInitialPhotoData:function(){var ua=q.getIndexForID(this.props.setid,this.props.photoid),va=q.getByIndexImmediate(this.props.setid,ua);return va?va:this._getThumbnailPhotoData();},_getThumbnailPhotoData:function(){if(!this.props.normaldimensions||!this.props.thumbsrc)return null;var ua=qa.deserialize(this.props.normaldimensions),va={id:this.props.photoid,image1:{width:ua.x,height:ua.y,uri:this.props.thumbsrc}};if(this.props.hiresdimensions){var wa=qa.deserialize(this.props.hiresdimensions);va.image2={width:wa.x,height:wa.y,uri:this.props.thumbsrc};}return va;},_enableSubscriptions:function(){this._subscriptions.addSubscriptions(g.subscribe('VaultSharerDialog/imagesShared',this.close),g.subscribe('SpotlightVaultViewer/imageDeleted',this._onDelete),this.viewState.subscribe('photo_fetch',this.setState.bind(this,{photoData:null},null)));},removePermalinkQueryData:function(ua){if(oa.isVaultBoxURI(ua))return new na(ua).removeQueryData('view_image');return ua;},_onShareClick:function(event){if(this.state.selectionSet.getLength()===0){this.state.selectionSet.add(this._getCurrentFBID());this.setState({selectionSet:this.state.selectionSet});}this._grid.createPost(event.target);},_onSelect:function(){var ua=this._getCurrentFBID();if(!this.state.selectionSet.contains(ua)){this.state.selectionSet.add(ua);}else this.state.selectionSet.remove(ua);this.setState({selectionSet:this.state.selectionSet,bounce:true});setTimeout(this.setState.bind(this,{bounce:false}),l.getBounceTimeout());},_onClickOptions:function(ua){if(ua==this.optionsMenuValues.CROP){this._enableCropping();}else if(ua==this.optionsMenuValues.ROTATE_LEFT){this._rotate('left');}else if(ua==this.optionsMenuValues.ROTATE_RIGHT){this._rotate('right');}else if(ua==this.optionsMenuValues.MAKE_COVER_PHOTO)this.close();},_rotate:function(ua){var va=this._getCurrentFBID(),wa={fbid:va,cs_ver:p.VIEWER_VAULTBOX};wa[ua]=1;var xa=this.viewState.getPosition();new j('/ajax/photos/photo/rotate/').setAllowCrossPageTransition(true).setData(wa).setFinallyHandler(this.rotationComplete.bind(this,xa)).setErrorHandler(this.rotationComplete.bind(this,xa)).setMethod('POST').setReadOnly(false).send();this.viewState.inform('photo_fetch');},rotationComplete:function(ua){if(ua==this.viewState.getPosition())q.getByIndex(this.props.setid,ua,this._updatePhoto);},_enableCropping:function(){u.setAction(u.action.MAKE_PROFILE).setFlowType(u.flow.VAULT).log(u.step.CROP);var ua=this.getDimensions().getOriginalDimensionsFromPhoto(this.state.photoData);this._photocrop=new o(this.refs.image.getDOMNode(),{},ua);this.setState({croppingMode:true});},_disableCropping:function(){u.setFlowType(u.flow.VAULT).log(u.step.CANCEL);this._photocrop&&this._photocrop.done(false);this.setState({croppingMode:false});},componentDidMount:function(){if(this.props.enablecropping)this._enableCropping();},_crop:function(){var ua=this._getCurrentFBID(),va=this.state.photoData.owner.id,wa=this._photocrop.done(),xa=this.getDimensions().getOriginalDimensionsFromPhoto(this.state.photoData);new t(ua,va).setErrorURI(na.getRequestURI()).setFlowType(u.flow.VAULT).saveCrop(wa,xa);this.setState({croppingMode:false,savingMode:true});},_isCroppingEnabled:function(){return this.state.croppingMode||this.state.savingMode;},_delete:function(event){var ua=new j('/ajax/vault/delete.php').setData({vault_image_ids:[this._getCurrentFBID()],source:r.SPOTLIGHT_VAULT_VIEWER}).setStatusElement(n.byClass(event.target,'stat_elem')).setRelativeTo(event.target);i.send(ua);},_onDelete:function(){this.close();q.clearSetCache(this.props.setid);},openURL:function(ua){var va=ua.getQueryData('view_image').view_image;if(!va)return false;this.viewState.page(this.viewState.getRelativeMovement(va));return true;},_getBottomBar:function(){if(!this.state.photoData)return null;if(this._isCroppingEnabled())return (v.createElement(fa,{onDone:this._crop,onCancel:this._disableCropping,saving:this.state.savingMode}));return (v.createElement(z,{className:"stat_elem"},v.createElement(aa,null,v.createElement(ba,{onClick:this._delete},"Eliminar"),this._getOptionsMenu(),v.createElement(v.DOM.div,{className:"_4_8j"},v.createElement(m,{size:m.SIZES.small,color:m.COLORS.blue,showonasync:true,className:"_535k"}))),v.createElement(aa,{itemmargin:"left"},v.createElement(k,{onClick:this._onShareClick,className:"_4_8j",count:this.state.selectionSet.getLength(),singularLabel:"Share Photo",pluralLabel:"Compartir fotos",bounce:this.state.bounce}))));},_getCheck:function(){if(!this.state.photoData||this._isCroppingEnabled())return null;var ua=this.state.selectionSet.contains(this._getCurrentFBID());return (v.createElement(ca,{bounce:this.state.bounce,selected:ua,onClick:this._onSelect}));},_getPagers:function(){if(this._isCroppingEnabled())return null;return v.createElement(ia,null);},_getOptionsMenu:function(){if(!this.state.photoData)return null;var ua=[],va=s.getDownloadURLFromData(this.state.photoData);if(va)ua.push({label:"Descargar",value:this.optionsMenuValues.DOWNLOAD,href:s.getDownloadURLFromData(this.state.photoData)});if(this.state.photoData.owner)ua.push({label:"Hacerla mi foto de perfil",value:this.optionsMenuValues.CROP});if(s.canViewerMakeCoverPhoto(this.state.photoData))ua.push({label:"Make Cover Photo",value:this.optionsMenuValues.MAKE_COVER_PHOTO,href:s.getCoverPhotoURLFromData(this.state.photoData)});ua.push({label:"Rotate Left",value:this.optionsMenuValues.ROTATE_LEFT});ua.push({label:"Rotate Right",value:this.optionsMenuValues.ROTATE_RIGHT});return (v.createElement(ha,{items:ua,callback:this._onClickOptions,onShow:this.setState.bind(this,{menuOpen:true},null),onHide:this.setState.bind(this,{menuOpen:false},null)}));},render:function(){var ua=this.getMedia(),va=this.getStageDimensions();return (v.createElement(w,{open:this.state.open,onHide:this.close},v.createElement(la,{active:this.state.menuOpen,onClick:this._onClickViewport,stageDimensions:va,media:ua,showLoadingIndicator:!this.state.photoData},v.createElement(da,{onClick:this.close,position:"left"}),this._getCheck(),this._getBottomBar(),this._getPagers())));}});e.exports=ta;},null);
__d("VaultBoxInit",["AsyncRequest","DOM","PhotoStore","React","SpotlightVaultViewer","SpotlightViewerInit","VaultPageGrid"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){var n={setID:'vault:images_by_date_taken',bootstrapWithElem:function(o){l.render(j.createElement(k,{open:true,gridid:o.getAttribute('data-grid-id'),setid:n.setID,photoid:o.getAttribute('data-fbid'),thumbsrc:h.find(o,'img').src,hiresdimensions:o.getAttribute('data-hi-res-dimensions'),normaldimensions:o.getAttribute('data-normal-dimensions')}));if(!i.hasBeenCreated(n.setID))new g('/ajax/photos/vaultbox/init_react.php').setRelativeTo(o).setData({photoID:o.getAttribute('data-fbid')}).send();},bootstrapFromPermalink:function(o,p,q,r){m.getInstanceWithCallback(q,function(){l.render(j.createElement(k,{open:true,setid:n.setID,initialpayload:o,photoid:p,gridid:q,enablecropping:r.enableCropping}));});}};e.exports=n;},null);